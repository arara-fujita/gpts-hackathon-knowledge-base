# 生成AIのはじめかた

2023年11月に[OpenAI](https://openai.com/)が[ChatGPT](https://chatgpt.com/)をリリースして以降、生成AIは急速は普及を見せました。現在では様々な業務や分野において生成AIを活用したサービスが急速に発表されています。

このセミナーでは、このような生成AIが当たり前となった世の中で、生成AIを活用していく上で必要な基礎知識を身に着けます。

## 対象者

このセミナーは以下のような方を対象としています。

- 生成AIに興味はあるが、何から始めればいいかわからない人
- 生成AIの基礎知識を身に着けたい人

## AIの歴史

「AI」というと、つい最近登場した技術という印象が強いのではないでしょうか。しかし、その歴史は非常に古く、1950年代後半〜1960年代には第1次AIブームが起こっています。その後も第2次AIブームが1980年代に、そして2000年代から現在にかけて第3次AIブームが起こっています。

第3次AIブームまで来ると、みなさんも記憶に新しい出来事が登場してくるのではないでしょうか。囲碁や将棋で人間とAIが対局している様子は、ニュースなどでも大きく取り上げられたのを覚えている人も多いかと思います。

![第3次AIブームのビッグウェーブ](/images/llm-history.jpeg)

引用：[松尾 豊『人工知能は人間を超えるか：ディープラーニングの先にあるもの』KADOKAWA出版、2015年、p.53。](https://www.kadokawa.co.jp/product/321410000316/)

このように、AIにはすでに長い歴史があります。ここ最近のAIの進化で最近になってAIが突然登場したように感じますが、現在のAIの進化の裏にはこのような歴史の積み重ねがあります。

それぞれのAIブームについて、ここでは深くは触れませんが、現在のAIがどのような歴史の中で生まれたのか、ぜひ一度調べてみてください。

## 生成AIとは？

AIの歴史を振り返った上で、それでは「生成AI」とは何なのでしょうか？

従来のAIは、特定の問題を解決するために設計されています。例えば、画像認識・テキスト認識・機械翻訳などがこれに当たります。これらの問題は明確で、「こんにちは」を英語に機械翻訳すると「Hello」となるように、結果もある程度予測できます。

![従来のAIの例](/images/llm-existing.png)

それに対して生成AIは、新しいコンテンツを生成できます。例えば、執筆・作曲・作画などがこれに当たります。このように、生成AIは創造性を必要とするタスクを実行することが可能です。ChatGPTに文章を作成させたことがある人は多いのではないでしょうか。

![生成AIの例](/images/llm-new.png)

こうしたAIの進化の裏にはDeep Learning（深層学習）やMachine Learning（機械学習）といった技術が利用されていますが、説明するとかなり専門的な話になってしまうので、ここでは割愛します。興味のある人はぜひ調べてみてください。

## 生成AIがテキストを出力する仕組み

まず、生成AIどうやってテキストを出力しているのでしょう。

ChatGPTを使っていたり「人工知能」という言葉を見ると「何かを考えて出力している」ように見えますが、実際にはそうではありません。

以下の図は、生成AIがテキストを出力する仕組みをわかりやすく表したものです。

![LLMの出力](/images/llmm-output.png)

生成AIは、事前に大量のデータを学習しています。この学習データを元に、生成AIは入力されたテキストに対して「最も適切だと思われるテキスト」を出力します。

以下は、生成AIに全く同じテキストを何度も入力している様子です。

[![LLMによる出力のゆらぎ](/images/llm-output.gif)](https://platform.openai.com/playground/chat?models=gpt-4o&preset=preset-IZ05V3N1XHewx2YEtI2lbGrt)

これを見ると分かる通り、実行するたびに異なるテキストが出力されています。

以下の表は、これを100回繰り返した結果です。

| 食べ物                 | 出力回数 |
| ---------------------- | -------- |
| ラーメンです           | 52       |
| カレーライスです       | 21       |
| 寿司です               | 11       |
| カレーです             | 5        |
| 焼肉です               | 3        |
| ピザです               | 1        |
| アイスクリームです     | 1        |
| うどんです             | 1        |
| そばです               | 1        |
| パスタです             | 1        |
| チョコレートケーキです | 1        |
| スパゲッティです       | 1        |
| ケーキです             | 1        |

この例だと52%の確率で「ラーメンです」と出力されることが分かります。逆に「そばです」や「ケーキです」は1%以下の確率でしか出力されません。

::: info
厳密な話をすると、生成AIが出力する仕組みは単純な確率論ではなくもっと複雑なものです。

しかし、ここでは生成AIを理解しやすいように簡単に説明しています。
:::

## ハルシネーション

生成AIを利用していて度々問題になるのが「ハルシネーション」という現象です。

これは、生成AIが事実とは異なる情報を出力することを指します。

以下はその一例です、明らかに間違ってることがわかるでしょう（わかりますよね？）。

[![ハルシネーション](/images/llm-hallucination.png)](https://platform.openai.com/playground/chat?models=gpt-3.5-turbo&preset=preset-EGFzCylsHyTUdcYh8aJPu64E)

::: details 正解は
みなさんならもちろん会長の名前をフルネーム漢字で書けますよね？
<!-- 三浦 嚴嗣 -->
:::

ではこれだとどうでしょう？

[![スレッタ忘れった](/images/llm-hallucination-suletta-forgetta.png)](https://platform.openai.com/playground/chat?preset=preset-xSMDrSGNsNf1EswSqHqiuoHs)

::: details 正解は
「アストリゼア工科大学」ではなく「アスティカシア高等専門学園」です。
:::

ガンダムに詳しい人であれば気づくかもしれませんが、たとえ詳しかったとして見落とす可能性もあるでしょう。

このようなハルシネーションが起こる理由はいくつかありますが、生成AIの性能ががどれだけ向上したとしても、仕組み上ハルシネーションを100%防ぐことはできません。

::: tip ハルシネーションの原因と対策
ハルシネーションが起こる主な理由は以下の2点です。

- 学習データ
- 生成AIの仕組み

まず学習データです。生成AIは大量のデータを元に学習していますが、そのデータに誤った情報が含まれていたりそもそも学習されていない情報の場合、誤った出力を行う可能性があります。

次に生成AIの仕組みですが、[生成AIがテキストを出力する仕組み](#生成aiがテキストを出力する仕組み)で説明した通り、生成AIはあくまで次に来るワードを推論しているに過ぎません。そのため、確率的に誤った情報を出力してしまう場合があります。

こうしたハルシネーションを完全に防ぐ方法はありませんが、軽減することはできます。

1つ目は単純に質の良い学習データを増やすことです。正確な学習データを追加することで、今まで回答できなかったものも出力できる確率が高くなります。

2つ目は「グラウンディング」というテクニックを利用して「仮にハルシネーションが起きてもわかるようにする」ことです。これは、生成AIの出力時に参照元の情報を併記することで、ユーザーがそれを確認・検証することができるようにすることです。
:::

## プロンプト・プロンプトエンジニアリング

生成AIに入力するテキストのことを「プロンプト（Prompt）」と呼びます。

このプロンプトを工夫することで、生成AIの出力をコントロールすることができます。

また、このプロンプトを工夫して生成AIの出力をコントロールすることを「プロンプトエンジニアリング（Prompt Engineering）」と呼びます。プロンプトエンジニアリングには様々なテクニックがあり、[Prompt Engineering Guide](https://www.promptingguide.ai/jp)などが参考になります。

上述した通り、生成AIの性能をどれだけ引き出せるかはプロンプトが大きく関わってきます。

ここでは、[Prompt Engineering Guide](https://www.promptingguide.ai/jp)を読みつつ、プロンプトエンジニアリングの基本的なテクニックを紹介します。

::: info 進め方
ここでは[Prompt Engineering Guide](https://www.promptingguide.ai/jp)を利用して進めていきます。

基本的には「[はじめに](https://www.promptingguide.ai/jp/introduction)」から「[Chain-of-Thoughtプロンプティング](https://www.promptingguide.ai/jp/techniques/cot)」までを覚えておけば大丈夫です。

より詳しくプロンプトエンジニアリングについて学びたい場合は続きも読んでみてください。
:::

## 生成AIをコア機能としたサービスと種類

最後に、生成AIをコア機能とした具体的なサービスとその種類を紹介します。

生成AIといっても生成するものは多岐に渡るため、自分の目的に合った生成AIを選ぶことが重要です。

### テキスト生成

これが最も身近でイメージしやすい生成AIでしょう。

ChatGPTなどのチャットボットや、文章の要約、文章の生成などがこれに該当します。

#### [ChatGPT](https://chatgpt.com/)

説明するまでもないでしょう。

#### [Claude AI](https://claude.ai/)

Claude AIは元OpenAIの社員が設立したAnthropicという会社によって開発された生成AI「Claude」を利用できるサービスです。

機能面ではChatGPTほど多機能ではありませんが、扱えるトークン数が200kトークン（GPT-4は128kトークン）と非常に大きいため、より長い文章を生成することが可能です。

また、Claudeはより自然な文章を生成することが得意です。

#### [Gemini](https://gemini.google.com/)

GeminiはGoogleが開発した生成AI「Gemini」を利用できるサービスです。

特徴は、Googleの各種サービスと連携できることです。たとえば、Googleドライブに保存されている議事録から要約を作成し、メールの下書きを作成するなどがシームレスに行えます。

また、回答時にGoogle検索を併用することもできます。

#### [perplexity](https://www.perplexity.ai/)

perplexityは、回答時にWeb検索を行うことで、より正確かつ最新の情報を踏まえた回答が可能なサービスです。

ユーザーの入力に対して適切な検索を行い、検索結果から総合的に判断したうえで回答してくれるため、ハルシネーションやナレッジカットオフによる誤った回答を防ぐことができます。

::: tip グラウンディング
生成AIの回答時にWeb検索やドキュメントを参照させることで、より正確な回答を出力することはできますが、100%の正確さを保証することはできません。

しかし、生成AIの回答に参照元の情報を併記することで、仮に誤った情報を回答してしまってもユーザーがそれを確認・検証することはできます。

このように、生成AIの回答と参照元の情報紐づけることを「グラウンディング」と呼びます。
:::

### 画像生成

画像生成AIとは、ユーザーの指示に従って画像を生成するAIです。

#### [DALL·E](https://openai.com/index/dall-e-3/)

OpenAIが開発した画像生成AIです。

ユーザーの入力したテキストにもとづいて画像を生成することが可能です。

#### [Midjourney](https://www.midjourney.com/)

画像生成では最も有名なサービスです。

プロンプトは基本的に英語のみになりますが、かなりクオリティの高い画像を生成することが可能です。

#### [Adobe Firefly](https://www.adobe.com/jp/products/firefly.html)

Adobeが開発した画像生成AIです。

Adobeの既存製品に組み込んで利用できるのが特徴です。

### 音声生成

音声生成AIとは、ユーザーの指示に従って音声を生成するAIです。

身近なものだと、音声アシスタントやテキスト読み上げなどがこれに該当します。

他にも最近は声だけでなく音楽を生成する生成AIも登場してきています。

#### [Suno](https://suno.com/)

テキストで曲のイメージを指定することで、そのイメージに合った音楽を生成することが可能です。

BGM以外にも、任意の歌詞を指定して歌を生成することも可能です。

#### [Udio](https://www.udio.com/)

こちらもSuno同様に、テキストで曲のイメージを指定することで、そのイメージに合った音楽を生成することが可能です。

## 【コラム】頻出キーワード

生成AIの話をしていると、以下のようなキーワードが頻出します。

生成AIについて理解を深めるには必須のキーワードになるので、イメージできる程度には理解しておきましょう。

### モデル

「モデル（Model）」とは、生成AIの種類のようなものです。

このモデルの違いによって、生成AIの性能やできることが変わってきます。

有名なものだと、OpenAIの「GPT」、Anthropicの「Claude」、Googleの「Gemini」などがあります。

以下の図を見ると分かる通り、モデルは更に細かく種類があるものもあります。

[![](https://mermaid.ink/img/pako:eNqFkktqwzAURbciNHIgNfnYE1MKoZ80g5JA0g6KJy-WGovYekaWCiVk3u4pe8oWKmO3SYg_b2Tdeyzdi7SjETJOA5oKyVLIQknsKETtOC_WSXq9UirGcaaL1e1a3R0P3_OMy8nsePg5B4qxyM3Y9S_FM4OsjFpjh01mMtfKRPp6b6_-V69tX69J_zwvd5-AYbzqN5E6VpiJqKZiCZKRO2jQh7V60QmkJkN3dOlXJ5Nx7zrmn0Xmmclb7CVKyXUL8Axiay7ukts7F1XdKeIm4TVdK8yGHtSkO5lkobDLJ28iFyhbsddEK2iK4LdF8Dsi-OQpgTymfZpylYJg9tXvCj6kOuYpD2lgPxmobUhDubccGI3LLxnRwL5F3qcmY6D5g4CNgpQGH5DkVs1AviOe1iX1yIRG9S8qNJu4Wu1_Ad6H5-8?type=png)](https://mermaid.live/edit#pako:eNqFkktqwzAURbciNHIgNfnYE1MKoZ80g5JA0g6KJy-WGovYekaWCiVk3u4pe8oWKmO3SYg_b2Tdeyzdi7SjETJOA5oKyVLIQknsKETtOC_WSXq9UirGcaaL1e1a3R0P3_OMy8nsePg5B4qxyM3Y9S_FM4OsjFpjh01mMtfKRPp6b6_-V69tX69J_zwvd5-AYbzqN5E6VpiJqKZiCZKRO2jQh7V60QmkJkN3dOlXJ5Nx7zrmn0Xmmclb7CVKyXUL8Axiay7ukts7F1XdKeIm4TVdK8yGHtSkO5lkobDLJ28iFyhbsddEK2iK4LdF8Dsi-OQpgTymfZpylYJg9tXvCj6kOuYpD2lgPxmobUhDubccGI3LLxnRwL5F3qcmY6D5g4CNgpQGH5DkVs1AviOe1iX1yIRG9S8qNJu4Wu1_Ad6H5-8)

モデルが違うと、生成AIの性能や得意分野も変わってきます。

有名なものだとGPTですが、Claudeはより自然な文章の作成が得意だったり、Geminiは長文でも正確に理解するのが得意だったりします。

::: info モデルの比較
より定量的にモデルの比較を行うには、様々な評価指標を用いてスコア化することが一般的です。

ここでは「モデルによって得意不得意がある」ということを覚えておいてください。
:::

### トークン

ChatGPTなどを利用していると、稀に以下のようなエラーが表示されることがあります。

![長過ぎるコンテキスト](/images/llm-too-long-context.png)

これは、現在利用しているモデルが理解できるトークン数を超えるテキストを入力しているために発生しています。

このトークンとは文字数のようなもので、日本語の場合はおよそ1文字1トークンちょっとと考えてもらえれば大丈夫です。

GPT-4の場合は128kトークンが上限になっているので、日本語だと約10万文字程度が上限になります。

::: tip 英語と日本語によるトークンの違い

先ほど「日本語の場合はおよそ1文字1トークン」と説明しましたが、これが英語になるとおよそ1単語1トークンになります。

以下のスクリーンショットは[Tokenizer](https://platform.openai.com/tokenizer)というモデルがどのようにテキストをトークンにしているかを可視化するツールです。

![Tokenizer](/images/llm-tokenizer-english.png)

![Tokenizer](/images/llm-tokenizer-japanese.png)

これを表にまとめると以下のようになります。

| 言語   | トークン数 | 文字数 | 1文字あたりのトークン数 |
| ------ | ---------- | ------ | ----------------------- |
| 英語   | 25         | 96     | 0.26                    |
| 日本語 | 57         | 44     | 1.30                    |

これからわかるように、日本語のほうが文字数は半分程度にも関わらず、英語のほうがトークン数が半分程度になっています。

たまに「生成AIは日本語よりも英語で使ったほうが性能が出る」という話を聞きますが、この辺りが関わってきています。

:::

### ナレッジカットオフ

生成AIは事前に学習した大量のデータを元に回答を出力しています。そのため、学習データに含まれていない情報については正しく回答ができないことがあります。

その代表的な例が最新の情報で、生成AIに「今日の天気は？」と聞いても正しく回答することはできません。

このように、「生成AIがどれだけ最新の情報を学習しているか」の境界のことをナレッジカットオフと呼びます。

「ナレッジカットオフが2023年12月」と言われると、その生成AIは2023年12月までの情報は学習していますが、それよりも新しい情報は学習していないという意味になります。

以下の例は、ナレッジカットオフが2023年10月のモデル（gpt-4o）と2021年9月のモデル（gpt-3.5-turbo）
による回答の違いを示しています。

![ナレッジカットオフ](/images/knowledge-cutoff.png)

### マルチモーダル

マルチモーダルとは、異なる種類のデータ（画像、音声、テキストなど）を入力として受け取ることができることです。

これを使うと、たとえば写真を入力して「ここに写っているものを説明してください」というようなことが可能になります。

<figure>
  <img src="https://www.softbank.jp/biz/function/dynamicmedia/deliver/dm-aid--fd4bf429-a264-44b3-b3d9-806c55b3b710/img-ai-glossary-multimodal-ai-230706.png?quality=100&width=2000&preferwebp=true" alt="マルチモーダルの説明" />
  <figcaption>
    <a href="https://www.softbank.jp/biz/solutions/generative-ai/ai-glossary/multimodal-ai/" target="__blank">マルチモーダルAI｜AI用語集｜法人向け｜ソフトバンク</a>より引用
  </figcaption>
</figure>

## まとめ

これで、生成AIをはじめるための基礎知識を身に着けることができました。

次回からはChatGPTを通して実際に生成AIを使っていきます。

::: info 次回以降の進め方について
次回以降はChatGPT Plusを利用していきます。

まだChatGPT Plusを契約していない人は事前に契約しておいてください。
:::
